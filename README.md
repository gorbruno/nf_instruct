# Инструкция по работе с nextflow nf-core пайплайнами

Nextflow — менеджер пайплайнов, позволяющий автоматизировать процессы анализа данных.

nf-core — движимый сообществом проект по унификации биоинформатических пайплайнов, написанных на nextflow.

## Запуск nextflow

### Требования

Nextflow работает на POSIX-совместимых системах (Linux, macOS, и.т.д). На Windows запускается через WSL. Для запуска nextflow требуются bash 3.2 (или более поздней версии), а также java минимум 11 версии.

Можно проверить версию Java:

```bash
java -version
```

Если подходящей версии нет, то её можно установить через [SDKMAN!](https://sdkman.io/):

1. [Установка SDKMAN](https://sdkman.io/install):

    ```bash
    curl -s https://get.sdkman.io | bash
    ```
    
2. Перезагрузка терминала.

3. Установка Java:

    ```bash
    sdk install java 17.0.10-tem
    ```
### Установка nextflow

1. Nextflow скачивается напрямую:

    ```bash
    curl -s https://get.nextflow.io | bash
    ```

2. Скачавшийся файл делается исполняемым:

    ```bash
    chmod +x nextflow
    ```

3. Программу можно переместить в исполняемый путь `(либо окружение)`:

    ```bash
    sudo mv nextflow /usr/local/bin
    ```

### Обновление

Для обновления используется следующая команда:

```bash
nextflow self-update
```

Для запуска определённой версии (например, 23.10.0) используется следующая команда :

```bash
NXF_VER=23.10.0 nextflow run hello
```

## Работа с nextflow

При первом запуске nextflow в корневой директории создаётся папка .nextflow, куда копируются необходимые для работы программы файлы. Все использованные пайплайны также хранятся в этой папке.

Пайплайны отдельно скачивать `не нужно`. Для запуска пайплайна достаточно указать его репозиторий на github:

```bash
nextflow run nf-core\viralrecon <params>
```

После первого использования в папку .nextflow копируется репозиторий пайплайна. При локальном редактировании файлов, пайплайн не будет запускаться, пока не будет сделан commit.  Но зачастую сам исходный код редактировать необязательно.

Для модификации пайплайнов в nextflow предусмотрены файлы конфигурации.
